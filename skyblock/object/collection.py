from typing import Optional

from ..function.io import red

from .object import Collection
from .recipe import get_recipe

__all__ = ['COLLECTIONS', 'is_collection', 'get_collection', 'calc_coll_lvl']


COLLECTIONS = [
    Collection(
        'wheat', 'farming',
        [
            (50, 5),
            (100, 10),
            (250, (get_recipe('farm_suit_helmet'),
                   get_recipe('farm_suit_chestplate'),
                   get_recipe('farm_suit_leggings'),
                   get_recipe('farm_suit_boots'))),
            (500, 50),
            (1_000, 100),
            (2_500, 250),
            (10_000, get_recipe('hay_to_enchanted')),
            (15_000, 1_500),
            (25_000, (get_recipe('farm_helmet'),
                      get_recipe('farm_chestplate'),
                      get_recipe('farm_leggings'),
                      get_recipe('farm_boots'))),
            (50_000, 5_000),
            (100_000, get_recipe('hay_to_tighted')),
        ],
    ),
    Collection(
        'carrot', 'farming',
        [
            (100, 10),
            (250, 25),
            (500, 50),
            (1_700, get_recipe('carrot_to_enchanted')),
            (5_000, 500),
            (10_000, 1_000),
            (25_000, get_recipe('carrot_to_enchanted_golden')),
            (50_000, 5_000),
            (100_000, 10_000),
        ],
    ),
    Collection(
        'potato', 'farming',
        [
            (100, 10),
            (250, 25),
            (500, 50),
            (1_700, get_recipe('potato_to_enchanted')),
            (5_000, 500),
            (10_000, get_recipe('scroll_to_barn')),
            (25_000, get_recipe('potato_to_enchanted_baked')),
            (50_000, 5_000),
            (100_000, 10_000),
        ],
    ),
    Collection(
        'pumpkin', 'farming',
        [
            (40, 4),
            (100, (get_recipe('pumpkin_helmet'),
                   get_recipe('pumpkin_chestplate'),
                   get_recipe('pumpkin_leggings'),
                   get_recipe('pumpkin_boots'))),
            (250, get_recipe('pumpkin_to_enchanted')),
            (1_000, 100),
            (2_500, 250),
            (5_000, 500),
            (10_000, 1_000),
            (25_000, 2_500),
            (50_000, get_recipe('farmer_boots')),
            (100_000, get_recipe('pumpkin_to_polished')),
            (250_000, get_recipe('ranchers_boots')),
        ],
    ),
    Collection(
        'melon', 'farming',
        [
            (250, 25),
            (500, 50),
            (1_200, 120),
            (5_000, get_recipe('melon_to_enchanted')),
            (15_500, get_recipe('melon_to_enchanted_glistering')),
            (25_000, get_recipe('melon_to_enchanted_block')),
            (50_000, 5_000),
            (100_000, 10_000),
            (250_000, 25_000),
        ],
    ),
    Collection(
        'seeds', 'farming',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, 100),
            (2_500, 250),
            (5_000, 500),
        ],
    ),
    Collection(
        'mushroom', 'farming',
        [
            (50, 5),
            (100, 10),
            (250, (get_recipe('mushroom_helmet'),
                   get_recipe('mushroom_chestplate'),
                   get_recipe('mushroom_leggings'),
                   get_recipe('mushroom_boots'))),
            (1_000, 100),
            (2_500, get_recipe('mushroom_block')),
            (5_000, get_recipe('mushroom_to_enchanted')),
            (10_000, 1_000),
            (25_000, get_recipe('mushroom_to_enchanted_block')),
            (50_000, 5_000),
        ],
    ),
    Collection(
        'cocoa', 'farming',
        [
            (75, 7.5),
            (200, 20),
            (500, 50),
            (2_000, get_recipe('cocoa_to_enchanted')),
            (5_000, get_recipe('scroll_to_desert')),
            (10_000, get_recipe('cocoa_to_enchanted_cookie')),
            (20_000, 2_000),
            (50_000, 5_000),
            (100_000, 10_000),
        ],
    ),
    Collection(
        'cactus', 'farming',
        [
            (100, 10),
            (250, (get_recipe('cactus_helmet'),
                   get_recipe('cactus_chestplate'),
                   get_recipe('cactus_leggings'),
                   get_recipe('cactus_boots'))),
            (500, 50),
            (1_000, get_recipe('cactus_to_enchanted_green')),
            (2_500, 250),
            (5_000, 500),
            (10_000, 1_000),
            (25_000, get_recipe('cactus_to_enchanted')),
            (50_000, 5_000),
        ],
    ),
    Collection(
        'sugar_cane', 'farming',
        [
            (100, 10),
            (250, 25),
            (500, 50),
            (1_000, get_recipe('cane_to_enchanted_sugar')),
            (2_000, get_recipe('cane_to_enchanted_paper')),
            (5_000, get_recipe('cane_to_enchanted_bookshelf')),
            (10_000, 1_000),
            (25_000, get_recipe('cane_to_enchanted')),
            (50_000, (get_recipe('speedster_helmet'),
                      get_recipe('speedster_chestplate'),
                      get_recipe('speedster_leggings'),
                      get_recipe('speedster_boots'))),
        ],
    ),
    Collection(
        'feather', 'farming',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, 100),
            (2_500, get_recipe('feather_to_enchanted')),
            (5_000, 500),
            (10_000, 1_000),
            (25_000, 2_500),
            (50_000, 5_000),
        ],
    ),
    Collection(
        'leather', 'farming',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, get_recipe('beef_to_enchanted')),
            (2_500, 250),
            (5_000, get_recipe('leather_to_enchanted')),
            (10_000, 1_000),
            (25_000, 2_500),
            (50_000, 5_000),
            (100_000, 10_000),
        ],
    ),
    Collection(
        'porkchop', 'farming',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, get_recipe('pork_to_enchanted')),
            (2_500, 250),
            (5_000, 500),
            (10_000, get_recipe('pork_to_enchanted_grilled')),
            (25_000, 2_500),
            (50_000, get_recipe('pigman_sword')),
        ],
    ),
    Collection(
        'chicken', 'farming',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, get_recipe('chicken_to_enchanted')),
            (2_500, get_recipe('egg_to_enchanted')),
            (5_000, 500),
            (10_000, get_recipe('enchanted_cake')),
            (25_000, 2_500),
            (50_000, get_recipe('egg_to_super_enchanted')),
        ],
    ),
    Collection(
        'mutton', 'farming',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, 100),
            (2_500, get_recipe('mutton_to_enchanted')),
            (5_000, 500),
            (10_000, 1_000),
            (25_000, get_recipe('mutton_to_enchanted_cooked')),
            (50_000, 5_000),
        ],
    ),
    Collection(
        'rabbit', 'farming',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, get_recipe('rabbit_foot_to_enchanted')),
            (2_500, 250),
            (5_000, get_recipe('rabbit_hide_to_enchanted')),
            (10_000, 1_000),
            (25_000, 2_500),
            (50_000, 5_000),
        ],
    ),
    Collection(
        'nether_wart', 'farming',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, get_recipe('nether_wart_to_enchanted')),
            (2_500, 250),
            (5_000, 500),
            (10_000, 1_000),
            (25_000, 2_500),
            (50_000, 5_000),
            (75_000, 7_500),
            (100_000, 10_000),
            (250_000, get_recipe('nether_wart_to_mutant')),
        ],
    ),
    Collection(
        'cobblestone', 'mining',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, get_recipe('cobblestone_to_enchanted')),
            (2_500, 250),
            (5_000, 500),
            (10_000, (get_recipe('miners_outfit_helmet'),
                      get_recipe('miners_outfit_chestplate'),
                      get_recipe('miners_outfit_leggings'),
                      get_recipe('miners_outfit_boots'))),
            (25_000, 2_500),
            (40_000, 4_000),
        ],
    ),
    Collection(
        'coal', 'mining',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, get_recipe('coal_to_enchanted')),
            (2_500, 250),
            (5_000, get_recipe('scroll_to_gold')),
            (10_000, get_recipe('coal_to_enchanted_block')),
            (25_000, 2_500),
            (50_000, 5_000),
        ],
    ),
    Collection(
        'iron', 'mining',
        [
            (50, 5),
            (100, get_recipe('golem_hat')),
            (250, 25),
            (1_000, get_recipe('iron_to_enchanted')),
            (2_500, 250),
            (5_000, (get_recipe('golem_armor_helmet'),
                     get_recipe('golem_armor_chestplate'),
                     get_recipe('golem_armor_leggings'),
                     get_recipe('golem_armor_boots'))),
            (10_000, get_recipe('iron_to_enchanted_block')),
            (25_000, get_recipe('golem_sword')),
            (50_000, 5_000),
            (100_000, 10_000),
            (200_000, 20_000),
            (400_000, 40_000),
        ],
    ),
    Collection(
        'gold', 'mining',
        [
            (50, 5),
            (100, get_recipe('cleaver')),
            (250, 25),
            (1_000, get_recipe('gold_to_enchanted')),
            (2_500, 250),
            (5_000, 500),
            (10_000, get_recipe('gold_to_enchanted_block')),
            (25_000, 2_500),
            (50_000, 5_000),
        ],
    ),
    Collection(
        'diamond', 'mining',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, get_recipe('diamond_to_enchanted')),
            (2_500, 250),
            (5_000, 500),
            (10_000, (get_recipe('hardened_diamond_helmet'),
                      get_recipe('hardened_diamond_chestplate'),
                      get_recipe('hardened_diamond_leggings'),
                      get_recipe('hardened_diamond_boots'))),
            (25_000, get_recipe('diamond_to_enchanted_block')),
            (50_000, (get_recipe('perfect_helmet'),
                      get_recipe('perfect_chestplate'),
                      get_recipe('perfect_leggings'),
                      get_recipe('perfect_boots'))),
        ],
    ),
    Collection(
        'lapis', 'mining',
        [
            (250, 25),
            (500, 50),
            (1_000, 100),
            (2_000, get_recipe('lapis_to_enchanted')),
            (10_000, 1_000),
            (25_000, 2_500),
            (50_000, get_recipe('lapis_to_enchanted_block')),
            (100_000, 10_000),
            (150_000, 15_000),
        ],
    ),
    Collection(
        'emerald', 'mining',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, get_recipe('emerald_to_enchanted')),
            (5_000, 500),
            (15_000, 1_500),
            (30_000, get_recipe('emerald_to_enchanted_block')),
            (50_000, get_recipe('emerald_blade')),
            (100_000, (get_recipe('emerald_helmet'),
                       get_recipe('emerald_chestplate'),
                       get_recipe('emerald_leggings'),
                       get_recipe('emerald_boots'))),
        ],
    ),
    Collection(
        'redstone', 'mining',
        [
            (100, 10),
            (250, 25),
            (750, 75),
            (1_500, get_recipe('redstone_to_enchanted')),
            (3_000, 300),
            (5_000, 500),
            (10_000, get_recipe('scroll_to_deep')),
            (25_000, get_recipe('redstone_to_enchanted_block')),
            (50_000, 5_000),
            (200_000, 20_000),
            (400_000, 40_000),
            (600_000, 60_000),
            (800_000, 80_000),
            (1_000_000, 100_000),
            (1_200_000, 120_000),
            (1_400_000, 140_000),
        ],
    ),
    Collection(
        'quartz', 'mining',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, get_recipe('quartz_to_enchanted')),
            (2_500, 250),
            (5_000, get_recipe('quartz_to_enchanted_block')),
            (10_000, 1_000),
            (25_000, 2_500),
            (50_000, 5_000),
        ],
    ),
    Collection(
        'obsidian', 'mining',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, get_recipe('obsidian_to_enchanted')),
            (2_500, 250),
            (5_000, 500),
            (10_000, 1_000),
            (25_000, 2_500),
            (50_000, 5_000),
            (100_000, 10_000),
        ],
    ),
    Collection(
        'glowstone', 'mining',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, get_recipe('glowstone_to_enchanted')),
            (2_500, 250),
            (5_000, get_recipe('glowstone_to_enchanted_block')),
            (10_000, get_recipe('glowstone_to_enchanted_lamp')),
            (25_000, 2_500),
            (50_000, 5_000),
        ],
    ),
    Collection(
        'gravel', 'mining',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, 100),
            (2_500, get_recipe('gravel_to_enchanted')),
            (5_000, 500),
            (10_000, 1_000),
            (15_000, get_recipe('scroll_to_spider')),
            (50_000, 5_000),
        ],
    ),
    Collection(
        'ice', 'mining',
        [
            (50, 5),
            (100, 10),
            (250, get_recipe('ice_to_packed')),
            (500, get_recipe('ice_to_enchanted')),
            (1_000, 100),
            (5_000, 500),
            (10_000, get_recipe('ice_to_enchanted_packed')),
            (50_000, get_recipe('frozen_scythe')),
            (100_000, 10_000),
            (250_000, 25_000),
        ],
    ),
    Collection(
        'netherrack', 'mining',
        [
            (50, 5),
            (250, 25),
            (500, 50),
            (1_000, get_recipe('netherrack_to_enchanted')),
            (5_000, 500),
        ],
    ),
    Collection(
        'sand', 'mining',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (500, 50),
            (1_000, get_recipe('sand_to_enchanted')),
            (2_500, 250),
            (5_000, 500),
        ],
    ),
    Collection(
        'end_stone', 'mining',
        [
            (50, 5),
            (100, 10),
            (250, 25),
            (1_000, get_recipe('end_stone_to_enchanted')),
            (2_500, 250),
            (5_000, 500),
            (10_000, 1_000),
            (15_000, get_recipe('scroll_to_end')),
            (25_000, 2_500),
            (50_000, get_recipe('end_stone_sword')),
        ],
    ),
    Collection(
        'mithril', 'mining',
        [
            (50, 5),
            (250, 25),
            (1_000, get_recipe('mithril_to_enchanted')),
            (2_500, 250),
            (5_000, get_recipe('mithril_coat')),
            (10_000, 1_000),
            (250_000, 25_000),
            (500_000, 50_000),
            (1_000_000, 100_000),
        ],
    ),
]


def is_collection(name: str) -> bool:
    for collection in COLLECTIONS:
        if collection.name == name:
            return True
    else:
        return False


def get_collection(name: str) -> Optional[Collection]:
    for collection in COLLECTIONS:
        if collection.name == name:
            return collection
    else:
        red(f'Unknown collection: {name!r}')


def calc_coll_lvl(name: str, amount: int) -> Optional[int]:
    if (collection := get_collection(name)) is None:
        return

    for lvl, (lvl_amount, _) in enumerate(collection):
        if amount < lvl_amount:
            return lvl
    else:
        return lvl + 1
